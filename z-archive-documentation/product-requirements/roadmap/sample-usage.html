<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CollectiveMind Product Roadmap</title>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/date-fns@2.30.0/index.js"></script>
  <script src="https://unpkg.com/framer-motion@10.16.0/dist/framer-motion.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    }
    .dark {
      color-scheme: dark;
    }
    @media (prefers-color-scheme: dark) {
      body {
        background-color: #1a202c;
        color: #e2e8f0;
      }
    }
  </style>
</head>
<body>
  <div id="root" class="container mx-auto px-4 py-8 max-w-7xl"></div>

  <script type="text/babel">
    // Sample implementation of the RoadmapVisualizer
    const App = () => {
      const [darkMode, setDarkMode] = React.useState(
        window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
      );
      
      React.useEffect(() => {
        if (darkMode) {
          document.documentElement.classList.add('dark');
        } else {
          document.documentElement.classList.remove('dark');
        }
      }, [darkMode]);

      const handleRefresh = async () => {
        // In a real implementation, this would call an API endpoint
        console.log('Refreshing roadmap data...');
        // Simulate a refresh delay
        await new Promise(resolve => setTimeout(resolve, 1000));
        alert('Roadmap data refreshed!');
      };

      return (
        <div className="space-y-6">
          <header className="flex justify-between items-center">
            <h1 className="text-3xl font-bold text-gray-900 dark:text-white">CollectiveMind</h1>
            <button
              onClick={() => setDarkMode(!darkMode)}
              className="px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-md"
            >
              Toggle {darkMode ? 'Light' : 'Dark'} Mode
            </button>
          </header>
          
          <div className="bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden">
            <RoadmapVisualizer
              configPath="roadmap-config.json"
              dataPath="roadmap-data.json"
              onRefresh={handleRefresh}
              className="min-h-[600px]"
            />
          </div>
          
          <footer className="text-center text-sm text-gray-500 dark:text-gray-400 pt-8">
            <p>This is a sample implementation of the RoadmapVisualizer component.</p>
            <p>Â© 2025 CollectiveMind. All rights reserved.</p>
          </footer>
        </div>
      );
    };

    // Simplified RoadmapVisualizer component for demo purposes
    const RoadmapVisualizer = ({ configPath, dataPath, onRefresh, className }) => {
      const [config, setConfig] = React.useState({
        roadmapTitle: 'Product Roadmap',
        timelineConfig: {
          startDate: '2025-01-01',
          endDate: '2025-12-31',
          timeUnits: ['quarter', 'month'],
          defaultView: 'month'
        },
        categories: [],
        statusTypes: [],
        priorityLevels: [],
        displayOptions: {
          showDependencies: true,
          showProgress: true,
          showMilestones: true,
          compactView: false,
          darkMode: false,
          filterByCategory: [],
          filterByStatus: [],
          filterByPriority: []
        }
      });
      const [data, setData] = React.useState(null);
      const [loading, setLoading] = React.useState(true);
      const [error, setError] = React.useState(null);
      const [filters, setFilters] = React.useState({
        categories: new Set(),
        status: new Set(),
        priority: new Set(),
        search: ''
      });
      const [selectedFeature, setSelectedFeature] = React.useState(null);

      // Load data
      React.useEffect(() => {
        const loadData = async () => {
          try {
            setLoading(true);
            // In a real implementation, these would be actual API calls
            // For demo purposes, we're using setTimeout to simulate network requests
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            // Fetch sample data
            const configResponse = await fetch(configPath);
            const dataResponse = await fetch(dataPath);
            
            const configData = await configResponse.json();
            const roadmapData = await dataResponse.json();
            
            setConfig(configData);
            setData(roadmapData);
            setError(null);
          } catch (err) {
            console.error('Error loading roadmap data:', err);
            setError('Failed to load roadmap data');
          } finally {
            setLoading(false);
          }
        };
        
        loadData();
      }, [configPath, dataPath]);

      // Filtered features
      const filteredFeatures = React.useMemo(() => {
        if (!data) return [];
        
        return data.features.filter(feature => {
          const matchesCategory = filters.categories.size === 0 || filters.categories.has(feature.category);
          const matchesStatus = filters.status.size === 0 || filters.status.has(feature.status);
          const matchesPriority = filters.priority.size === 0 || filters.priority.has(feature.priority);
          const matchesSearch = !filters.search || 
            feature.name.toLowerCase().includes(filters.search.toLowerCase()) ||
            feature.description.toLowerCase().includes(filters.search.toLowerCase());
          
          return matchesCategory && matchesStatus && matchesPriority && matchesSearch;
        });
      }, [data, filters]);

      // Handle refresh
      const handleRefresh = async () => {
        if (onRefresh) {
          try {
            setLoading(true);
            await onRefresh();
            
            // Reload data after refresh
            const configResponse = await fetch(configPath);
            const dataResponse = await fetch(dataPath);
            
            const configData = await configResponse.json();
            const roadmapData = await dataResponse.json();
            
            setConfig(configData);
            setData(roadmapData);
            setError(null);
          } catch (err) {
            console.error('Error refreshing roadmap data:', err);
            setError('Failed to refresh roadmap data');
          } finally {
            setLoading(false);
          }
        }
      };

      // Helper functions
      const getTimelinePosition = (date) => {
        const start = new Date('2025-01-01');
        const current = new Date(date);
        const totalDays = 365;
        const daysPassed = Math.floor((current.getTime() - start.getTime()) / (1000 * 60 * 60 * 24));
        return (daysPassed / totalDays) * 100;
      };

      const getTimelineWidth = (startDate, endDate) => {
        const start = new Date(startDate);
        const end = new Date(endDate);
        const totalDays = 365;
        const duration = Math.floor((end.getTime() - start.getTime()) / (1000 * 60 * 60 * 24));
        return (duration / totalDays) * 100;
      };

      const getStatusColor = (statusId) => {
        const status = config.statusTypes.find(s => s.id === statusId);
        return status?.color || '#9AA0A6';
      };

      // Loading state
      if (loading) {
        return (
          <div className="flex items-center justify-center min-h-[400px]">
            <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500" />
          </div>
        );
      }

      // Error state
      if (error) {
        return (
          <div className="flex items-center justify-center min-h-[400px] text-red-500">
            <div className="text-center">
              <p className="text-lg font-semibold mb-2">{error}</p>
              <button
                onClick={handleRefresh}
                className="px-4 py-2 bg-red-100 text-red-700 rounded-md hover:bg-red-200 transition-colors"
              >
                Try Again
              </button>
            </div>
          </div>
        );
      }

      // No data state
      if (!data) {
        return (
          <div className="flex items-center justify-center min-h-[400px] text-gray-500">
            <p>No roadmap data available</p>
          </div>
        );
      }

      return (
        <div className={`bg-white dark:bg-gray-900 ${className}`}>
          {/* Header */}
          <div className="flex justify-between items-center mb-6 p-4">
            <h1 className="text-2xl font-bold text-gray-900 dark:text-white">
              {config.roadmapTitle}
            </h1>
            <div className="flex items-center space-x-4">
              <p className="text-sm text-gray-500 dark:text-gray-400">
                Last updated: {dateFns.format(new Date(data.lastUpdated), 'PPP')}
              </p>
              <button
                onClick={handleRefresh}
                className="px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors"
              >
                Refresh
              </button>
            </div>
          </div>

          {/* Filters */}
          <div className="flex flex-wrap gap-4 mb-6 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg">
            {/* Search */}
            <div className="flex-1 min-w-[200px]">
              <input
                type="text"
                placeholder="Search features..."
                value={filters.search}
                onChange={(e) => setFilters(f => ({ ...f, search: e.target.value }))}
                className="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-900 text-gray-900 dark:text-white"
              />
            </div>

            {/* Category filter */}
            <div className="flex flex-wrap gap-2">
              {config.categories.map(category => (
                <button
                  key={category.id}
                  onClick={() => setFilters(f => ({
                    ...f,
                    categories: f.categories.has(category.id)
                      ? new Set([...f.categories].filter(id => id !== category.id))
                      : new Set([...f.categories, category.id])
                  }))}
                  className={`px-3 py-1 rounded-full text-sm ${
                    filters.categories.has(category.id)
                      ? 'bg-blue-500 text-white'
                      : 'bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300'
                  }`}
                >
                  {category.name}
                </button>
              ))}
            </div>

            {/* Status filter */}
            <div className="flex flex-wrap gap-2">
              {config.statusTypes.map(status => (
                <button
                  key={status.id}
                  onClick={() => setFilters(f => ({
                    ...f,
                    status: f.status.has(status.id)
                      ? new Set([...f.status].filter(id => id !== status.id))
                      : new Set([...f.status, status.id])
                  }))}
                  className={`px-3 py-1 rounded-full text-sm ${
                    filters.status.has(status.id)
                      ? 'bg-blue-500 text-white'
                      : 'bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300'
                  }`}
                >
                  {status.name}
                </button>
              ))}
            </div>
          </div>

          {/* Timeline */}
          <div className="overflow-x-auto">
            <div className="min-w-[800px] p-4">
              {/* Timeline header */}
              <div className="grid grid-cols-[200px_1fr] mb-4">
                <div className="font-semibold text-gray-900 dark:text-white">Feature</div>
                <div className="grid grid-cols-12 gap-1">
                  {Array.from({ length: 12 }, (_, i) => (
                    <div
                      key={i}
                      className="text-center text-sm text-gray-500 dark:text-gray-400"
                    >
                      {dateFns.format(new Date(2025, i), 'MMM')}
                    </div>
                  ))}
                </div>
              </div>

              {/* Timeline rows */}
              <div className="space-y-4">
                {filteredFeatures.map(feature => (
                  <div
                    key={feature.id}
                    className="grid grid-cols-[200px_1fr] items-center cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 p-2 rounded-md"
                    onClick={() => setSelectedFeature(feature.id)}
                  >
                    <div className="font-medium text-gray-900 dark:text-white">
                      {feature.name}
                    </div>
                    <div className="relative h-8">
                      <div
                        className="absolute h-full rounded-full"
                        style={{
                          left: `${getTimelinePosition(feature.startDate)}%`,
                          width: `${getTimelineWidth(feature.startDate, feature.endDate)}%`,
                          backgroundColor: getStatusColor(feature.status)
                        }}
                      >
                        <div
                          className="h-full rounded-full bg-white bg-opacity-30"
                          style={{ width: `${feature.progress}%` }}
                        />
                      </div>
                    </div>
                  </div>
                ))}
              </div>
            </div>
          </div>

          {/* Feature details modal */}
          {selectedFeature && (
            <div
              className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"
              onClick={() => setSelectedFeature(null)}
            >
              <div
                className="bg-white dark:bg-gray-900 rounded-lg p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto"
                onClick={(e) => e.stopPropagation()}
              >
                {/* Feature detail content */}
                {(() => {
                  const feature = data.features.find(f => f.id === selectedFeature);
                  if (!feature) return null;
                  
                  const status = config.statusTypes.find(s => s.id === feature.status);
                  const category = config.categories.find(c => c.id === feature.category);
                  const priority = config.priorityLevels.find(p => p.id === feature.priority);
                  
                  return (
                    <div>
                      <div className="flex justify-between items-start mb-4">
                        <h2 className="text-xl font-bold text-gray-900 dark:text-white">
                          {feature.name}
                        </h2>
                        <button
                          onClick={() => setSelectedFeature(null)}
                          className="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"
                          aria-label="Close"
                        >
                          <svg className="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                          </svg>
                        </button>
                      </div>

                      <div className="space-y-4">
                        <p className="text-gray-600 dark:text-gray-300">{feature.description}</p>

                        <div className="grid grid-cols-2 gap-4">
                          <div>
                            <p className="text-sm text-gray-500 dark:text-gray-400">Status</p>
                            <p className="font-medium text-gray-900 dark:text-white">
                              {status?.name || feature.status}
                            </p>
                          </div>
                          <div>
                            <p className="text-sm text-gray-500 dark:text-gray-400">Category</p>
                            <p className="font-medium text-gray-900 dark:text-white">
                              {category?.name || feature.category}
                            </p>
                          </div>
                          <div>
                            <p className="text-sm text-gray-500 dark:text-gray-400">Priority</p>
                            <p className="font-medium text-gray-900 dark:text-white">
                              {priority?.name || feature.priority}
                            </p>
                          </div>
                          <div>
                            <p className="text-sm text-gray-500 dark:text-gray-400">Progress</p>
                            <div className="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full mt-2">
                              <div
                                className="h-full bg-blue-500 rounded-full"
                                style={{ width: `${feature.progress}%` }}
                              />
                            </div>
                          </div>
                        </div>

                        <div>
                          <p className="text-sm text-gray-500 dark:text-gray-400 mb-2">Timeline</p>
                          <div className="flex items-center space-x-4">
                            <div>
                              <p className="text-sm text-gray-500 dark:text-gray-400">Start</p>
                              <p className="font-medium text-gray-900 dark:text-white">
                                {dateFns.format(new Date(feature.startDate), 'PP')}
                              </p>
                            </div>
                            <div className="flex-1 h-px bg-gray-300 dark:bg-gray-700" />
                            <div>
                              <p className="text-sm text-gray-500 dark:text-gray-400">End</p>
                              <p className="font-medium text-gray-900 dark:text-white">
                                {dateFns.format(new Date(feature.endDate), 'PP')}
                              </p>
                            </div>
                          </div>
                        </div>

                        {feature.dependencies.length > 0 && (
                          <div>
                            <p className="text-sm text-gray-500 dark:text-gray-400 mb-2">Dependencies</p>
                            <div className="flex flex-wrap gap-2">
                              {feature.dependencies.map(dep => {
                                const depFeature = data.features.find(f => f.id === dep);
                                return (
                                  <span
                                    key={dep}
                                    className="px-2 py-1 bg-gray-100 dark:bg-gray-800 rounded text-sm text-gray-700 dark:text-gray-300"
                                  >
                                    {depFeature ? depFeature.name : dep}
                                  </span>
                                );
                              })}
                            </div>
                          </div>
                        )}

                        <div>
                          <p className="text-sm text-gray-500 dark:text-gray-400 mb-2">Team</p>
                          <div className="space-y-2">
                            <div>
                              <p className="text-sm text-gray-500 dark:text-gray-400">Owner</p>
                              <p className="font-medium text-gray-900 dark:text-white">{feature.owner}</p>
                            </div>
                            <div>
                              <p className="text-sm text-gray-500 dark:text-gray-400">Contributors</p>
                              <div className="flex flex-wrap gap-2">
                                {feature.contributors.map(contributor => (
                                  <span
                                    key={contributor}
                                    className="px-2 py-1 bg-gray-100 dark:bg-gray-800 rounded text-sm text-gray-700 dark:text-gray-300"
                                  >
                                    {contributor}
                                  </span>
                                ))}
                              </div>
                            </div>
                          </div>
                        </div>

                        <div className="flex justify-between pt-4 border-t border-gray-200 dark:border-gray-700">
                          <a
                            href={feature.documentationPath}
                            className="text-blue-500 hover:text-blue-600 dark:text-blue-400 dark:hover:text-blue-300"
                          >
                            View Documentation
                          </a>
                          <a
                            href={feature.implementationPath}
                            className="text-blue-500 hover:text-blue-600 dark:text-blue-400 dark:hover:text-blue-300"
                          >
                            View Implementation Plan
                          </a>
                        </div>
                      </div>
                    </div>
                  );
                })()}
              </div>
            </div>
          )}
          
          {/* Milestones section */}
          <div className="mt-12 p-4">
            <h2 className="text-xl font-bold mb-4 text-gray-900 dark:text-white">Milestones</h2>
            <div className="space-y-4">
              {data.milestones.map(milestone => (
                <div 
                  key={milestone.id}
                  className="border border-gray-200 dark:border-gray-700 rounded-lg p-4"
                >
                  <div className="flex justify-between items-start">
                    <div>
                      <h3 className="font-bold text-gray-900 dark:text-white">{milestone.name}</h3>
                      <p className="text-sm text-gray-500 dark:text-gray-400">
                        {dateFns.format(new Date(milestone.date), 'PPP')}
                      </p>
                    </div>
                    <span 
                      className={`px-2 py-1 rounded-full text-xs ${
                        milestone.status === 'completed' ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200' :
                        milestone.status === 'in-progress' ? 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200' :
                        'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200'
                      }`}
                    >
                      {milestone.status === 'completed' ? 'Completed' :
                       milestone.status === 'in-progress' ? 'In Progress' :
                       'Planned'}
                    </span>
                  </div>
                  <p className="mt-2 text-gray-600 dark:text-gray-300">{milestone.description}</p>
                  
                  {milestone.features.length > 0 && (
                    <div className="mt-3">
                      <p className="text-sm text-gray-500 dark:text-gray-400 mb-1">Features:</p>
                      <div className="flex flex-wrap gap-2">
                        {milestone.features.map(featureId => {
                          const feature = data.features.find(f => f.id === featureId);
                          return feature ? (
                            <span
                              key={featureId}
                              className="px-2 py-1 bg-gray-100 dark:bg-gray-800 rounded text-sm text-gray-700 dark:text-gray-300 cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-700"
                              onClick={() => setSelectedFeature(featureId)}
                            >
                              {feature.name}
                            </span>
                          ) : null;
                        })}
                      </div>
                    </div>
                  )}
                </div>
              ))}
            </div>
          </div>
        </div>
      );
    };

    // Render the app
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html> 